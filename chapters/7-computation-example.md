# 计算例子

在本章中我们用一个实际的例子来介绍怎样从给定的 level 2 的 Coxeter 图出发绘制一个球堆。这里我们以 rank=4, level=2 为例，这时得到的是二维球堆。

1. $\Delta=\{\alpha_i\}_{i=1}^4$ 满足 $(\alpha_i,\alpha_i)=1$，它们是 4 个球面镜 $\{B_i\}_{i=1}^4$。关于它们的反演生成了 $W$。
2. $\Delta^\ast = \{\omega_i\}_{i=1}^4$，每一个都是实的。它们归一化以后得到的 $\{\myhat{\omega_i}\}$ 是 4 个互相分离的球 $\{C_i\}_{i=1}^4$。
3. 当 $i\ne j$ 时 $(\alpha_i, \omega_j)=0$，所以球 $B_i$ 和 $C_j$ 正交。
4. 又 $(\alpha_i,\omega_i)=1$，以及根据 @Pre:level-2 每个 $\omega_i$ 满足 $0<(\omega_i,\omega_i)\leq1$，所以归一化以后 $(\alpha_i,\myhat{\omega_i})>1$，即球 $B_i$ 和 $C_i$ 是不相交的。
5. 将 ${C_i}$ 关于 $B_i$ 反复反射，得到的所有球即为球堆 $\P=\bigcup\limits_{w\in W,\,1\leq i\leq 4}w(\myhat{\omega_i})$。

我们按照如下步骤来分别计算 $\{B_i\}$ 和 $\{C_j\}$：

1. $C_1$ 总是可以取为单位球 $\a=(0,0),\,r=1$。
2. $B_3,B_4$ 可以取为过原点的两条直线，法向量分别为 $\n_3=(1, 0)$ 和 $\n_4=(-\cos\frac{\pi}{m_{3,4}},\sin\frac{\pi}{m_{3,4}})$。
3. $B_2(\a_2,r_2)$ 是一个球，根据 $B_2$ 与 $C_1$ 正交可得 $|\a_2|^2=r_2^2+1$；由 $B_2$ 与 $B_3,B_4$ 的夹角可得 $\frac{(\a_2,\n_3)}{r_2}=\cos\frac{\pi}{m_{23}}$，$\frac{(\a_2,\n_4)}{r_2}=\cos\frac{\pi}{m_{24}}$。由这三个方程可以解出 $\a_2$ 和 $r_2$。
4. $B_1(\a_1,r_1)$ 也是一个球，由 $B_1$ 与 $B_3,B_4$ 夹角可得 $\frac{(\a_1,\n_3)}{r_1}=\cos\frac{\pi}{m_{13}}$，$\frac{(\a_1,\n_4)}{r_1}=\cos\frac{\pi}{m_{14}}$；由 $B_1$ 与 $B_2$ 夹角可得 $\frac{r_1^2+r_2^2-|\a_1-\a_2|^2}{2r_1r_2}=\cos\frac{\pi}{m_{12}}$。由这三个方程可以得到一个二次方程，解出的 $r_1$ 有两个值，我们取较小的那一个。（原因在后面解释）
5. 我们还剩下三个实球 $C_2,C_3,C_4$ 需要解出。$C_2$ 需要和 $B_3,B_4$ 正交，所以它是一个以原点为中心的球，而它又要和 $B_1$ 正交，所以 $C_2$ 的半径为 $\sqrt{|\a_1|^2-r_1^2}$。
6. $C_3$ 与 $B_4$ 正交，于是 $\frac{(\a,\n_4)}=0$；$C_3$ 与 $B_1,B_2$ 正交，这又可以得出两个方程。三个方程联合可以解出 $C_3$。
7. 利用 $C_4$ 与 $B_1,B_2,B_3$ 正交可以解出 $C_4$。

结果如下图所示，$B_i$ 用实线绘制，$C_i$ 用虚线绘制，同一对 $(B_i,C_i)$ 使用同样的颜色。${\rm inv}$ 表示该圆被翻转，以无穷区域为内部。注意到每个 $C_i$ 都位于 $B_i$ 的内部（正半空间），这是因为 $(\alpha_i,\omega_i)\geq1$，所以它们一定是一个包含另一个。这也解释了为什么求解 $B_1$ 时要用较小的那个半径：它的内部（无穷区域）必须包含 $C_1$ 的内部（也是个无穷区域）。

![](images/balls.svg){width=400}