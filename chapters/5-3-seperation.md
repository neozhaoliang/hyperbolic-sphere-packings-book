## 球面的 seperation

设 $B_1,B_2$ 是 $\R^n$ 中的两个球，球心分别为 $\a_1,\a_2$，半径分别为 $r_1,r_2$。记
$$k_1=\sph{\a_1}{r_1},\quad k_2=\sph{\a_2}{r_2}$$
分别是它们在 $\S$ 中对应的点，不难验证有
$$(k_1,k_2)=\frac{r_1^2+r_2^2 - |\a_1-\a_2|^2}{2r_1r_2}.$$
我们称如上的内积 $(k_1,k_2)$ 为 $B_1$ 和 $B_2$ 的 **seperation**。

1. $B_1$ 和 $B_2$ 相交当且仅当 $|(k_1,k_2)|\leq1$，这时 $(k_1,k_2)=\cos\theta$，$\theta$ 是它们球面交点处的内法向量夹角（用外法向量也可以，因为同时将内法向量变成外法向量，夹角的余弦不变）。当 $(k_1,k_2)=-1$ 时两球外切，$(k_1,k_2)=1$ 时两球内切。
2. $B_1$ 和 $B_2$ 不交当且仅当 $|(k_1,k_2)|>1$，这时 $|(k_1,k_2)|=\cosh\eta$，$\eta$ 是 $k_1,k_2$ 对应的双曲空间中测地线的双曲距离。两球在 $(k_1,k_2)<-1$ 时没有公共的内部，在 $(k_1,k_2)>1$ 时一个完全包含另一个。[见 @ratcliffe section 3.2]

|   |   |
|:---:|:---:|
| $(k_1,k_2)=\cos\theta$ |  $(k_1,k_2)=\cosh d(\ell_1,\ell_2)$  |
|![](images/image0.jpg){width=150} | ![](images/image1.jpg){width=150}  |
| $(k_1,k_2)=-\cosh d(\ell_1,\ell_2)$    | $(k_1,k_2)=-\cosh d(\ell_1,\ell_2)$|
|![](images/image2.jpg){width=150} | ![](images/image3.jpg){width=150}|

上面的结论同样适用于 $B_1$ 和 $B_2$ 中有平面的情形。例如设 $B_1,B_2$ 相交，并且 $B_1$ 是球面，$B_2$ 是超平面，其方程为 $(\x,\n)=d$，则 $k_2=(\n, 0, 2d)$，
$$(k_1,k_2)=\frac{(\a_1,\n)-d}{r_1}.$$
这时 $(k_1,k_2)$ 等于 $B_1$ 在球面交点处的内法向量和平面法向量夹角的余弦。

此外，当 $B_1,B_2$ 都是超平面时，$(k_1,k_2)=(\n_1,\n_2)$ 是它们法向量的夹角。

::: {.proposition #suff-for-disjoint}
设 $B_1,B_2$ 是两个球，且 $B_1,B_2$ 的内部不相交。设 $(k_1,k_2)$ 分别是它们对应的 space-like 的单位向量，则 $(k_1,k_2)\leq-1$。
:::

:::note
这个命题反过来是不对的。
:::

**证明**：$B_1$ 和 $B_2$ 内部不相交有如下几种可能：

1. $B_1,B_2$ 都是球，半径 $r_1,r_2$ 都大于 0，并且 $r_1+r_2 \geq |\a_1-\a_2|$。
2. $B_1,B_2$ 都是球，半径 $r_1>0,\, r_2<0$，且 $B_1$ 位于 $B_2$ 另一侧的有界区域，即 $-r_2-r_1\geq |\a_1-\a_2|$。
3. $B_1$ 是球，其半径 $r_1>0$；$B_2$ 是超平面，且 $B_1$ 位于 $B_2$ 的负半空间，从而其球心 $\a_1$ 到 $(\n,\x)=d$ 的有向距离 $\leq-r_1$，即 $(\a_1,\n)-d\leq -r_1$。
4. $B_1,B_2$ 是互相平行的超平面，且法向量相反的，即 $(\n_1,\n_2)=-1$。

不难验证这些都可以推出 $(k_1,k_2)\leq-1$。